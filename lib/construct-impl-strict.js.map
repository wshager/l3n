{"version":3,"sources":["../src/construct-impl-strict.js"],"names":["_n","type","name","children","len","length","first","streaming","Array","isArray","c","parent","ref","parentIsCx","__vnode_context","node","vnode","create","depth","reduce","modify","_v","_attrValue","value","parentType","_a","child","val","_dt","qname","publicId","systemId"],"mappings":"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","sourcesContent":["import { isVNode } from \"./vnode\";\r\n\r\nimport { isObservable, of, from } from \"rxjs\";\r\n\r\nimport { _n as _n2, _a as _a2, _v as _v2 } from \"./construct-impl-streaming\";\r\n\r\nimport vnode from \"./faux-vnode\";\r\n\r\nimport { isString } from \"./util\";\r\n\r\nexport function _n(type, name, children) {\r\n\tconst len = children.length;\r\n\t// if there's only one \"children\" argument it could be an Array\r\n\tif(len == 1) {\r\n\t\tconst first = children[0];\r\n\t\tif(isObservable(first)) return _n2(type,name,first);\r\n\t\tif(isVNode(first) && first.streaming) return _n2(type,name,of(first));\r\n\t\tif(Array.isArray(first)) children = first;\r\n\t}\r\n\tfor(let c of children) {\r\n\t\tif(isObservable(c) || (isVNode(c) && c.streaming)) return _n2(type,name,from(children));\r\n\t}\r\n\treturn vnode(function (parent, ref) {\r\n\t\t/*var ns;\r\n\t\tif (type == 1) {\r\n\t\t\tif (isQName(name)) {\r\n\t\t\t\tns = name;\r\n\t\t\t\tname = name.name;\r\n\t\t\t} else if (/:/.test(name)) {\r\n\t\t\t\t// TODO where are the namespaces?\r\n\t\t\t}\r\n\t\t}*/\r\n\t\tconst parentIsCx = parent.__vnode_context;\r\n\t\t// convert to real VNode instance\r\n\t\tvar node = parent.vnode(parent.create(type, name), parentIsCx ? null : parent, parentIsCx ? 0 : parent.depth + 1, 0, type);\r\n\t\treturn children.reduce((node,c) => node.modify(isVNode(c) ? typeof c.node == \"function\" ? c.node(node) : c : _v(isString(c) ? 3 : 12,c).node(node),ref),node);\r\n\t}, type, name);\r\n}\r\n\r\nconst _attrValue = (value,parentType) => {\r\n\tif(parentType == 1) return _v(3,value+\"\");\r\n\treturn _v(isString(value) ? 3 : 12,value);\r\n};\r\n\r\nexport function _a(name, child) {\r\n\tif(isObservable(child) || (isVNode(child) && child.streaming)) return _a2(name,child);\r\n\treturn vnode(parent => {\r\n\t\t// provide a provisional entry in the parent (without a value)\r\n\t\tvar node = parent.vnode(parent.create(2,name), parent);\r\n\t\t// node is an attr node /w child as $val\r\n\t\treturn node.modify(isVNode(child) ? typeof child.node == \"function\" ? child.node(node) : child : _attrValue(child,parent.type).node(node));\r\n\t}, 2, name);\r\n}\r\n\r\nexport function _v(type, val) {\r\n\tif(isObservable(val)) return _v2(type,val);\r\n\treturn vnode(\r\n\t\t// set by type, not by key (for attrs the keys are already filled in by pair)\r\n\t\tparent => parent.vnode(parent.create(type,val), parent),\r\n\t\ttype,\r\n\t\tnull,\r\n\t\tval\r\n\t);\r\n}\r\n\r\nexport function _dt(qname,publicId,systemId) {\r\n\treturn vnode(parent => parent.vnode(parent.create(10,{qname:qname,publicId:publicId,systemId:systemId}),parent,1,0),10);\r\n}\r\n"],"file":"construct-impl-strict.js"}